#!/usr/bin/env sh

# Protect master/main branch from direct pushes
current_branch=$(git symbolic-ref --short HEAD)
if [ "$current_branch" = "master" ] || [ "$current_branch" = "main" ]; then
    echo "‚ùå Direct pushes to master/main are not allowed!"
    echo "Please create a feature branch and submit a pull request."
    echo ""
    echo "To create a feature branch:"
    echo "  git checkout -b feature/your-feature-name"
    exit 1
fi

# Run static analysis before push
echo "Running PHPStan static analysis..."
yarn lint:php:phpstan
