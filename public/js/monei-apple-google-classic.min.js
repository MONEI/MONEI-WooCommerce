!function(e){"use strict";e(document.body).on("updated_checkout",function(e,o){t.update_apple_google_label(),"object"==typeof o&&o.fragments&&o.fragments.monei_new_total&&(t.total=o.fragments.monei_new_total),t.is_apple_selected()&&t.init_apple_google_pay()}),e("form#order_review").on("click",function(){t.is_apple_selected()&&t.init_apple_google_pay()});var t={$checkout_form:e("form.woocommerce-checkout"),$add_payment_form:e("form#add_payment_method"),$order_pay_form:e("form#order_review"),$cardInput:null,$container:null,$payment_request_container:null,$errorContainer:null,$paymentForm:null,is_checkout:!1,is_add_payment_method:!1,is_order_pay:!1,form:null,submitted:!1,init_counter:0,init_apple_counter:0,total:wc_monei_apple_google_params.total,cardholderNameRegex:/^[A-Za-zÀ-ú- ]{5,50}$/,init:function(){this.$checkout_form.length&&(this.is_checkout=!0,this.form=this.$checkout_form),this.$add_payment_form.length&&(this.is_add_payment_method=!0,this.form=this.$add_payment_form),this.$order_pay_form.length&&(t.is_apple_selected()&&t.init_apple_google_pay(),this.is_order_pay=!0,this.form=this.$order_pay_form,e('input[name="payment_method"]').on("change",function(){t.is_apple_selected()&&t.init_apple_google_pay()})),this.form&&this.form.on("change",this.on_change)},on_change:function(){e("[name='payment_method']").on("change",function(){t.on_payment_selected()}),e("[name='wc-monei-payment-token']").on("change",function(){t.on_payment_selected()})},on_payment_selected(){if(t.is_apple_selected())return t.init_apple_google_pay(),console.log("after"),t.is_checkout&&e("[name='woocommerce_checkout_place_order']").attr("data-monei","submit"),e("#place_order").prop("disabled",!0),!1;t.is_checkout&&(e("#place_order").prop("disabled",!1),e("[name='woocommerce_checkout_place_order']").removeAttr("data-monei"))},is_apple_selected:function(){return e("#payment_method_monei_apple_google").is(":checked")},init_apple_google_pay:function(){t.$payment_request_container&&0===t.$payment_request_container.childElementCount&&(t.init_apple_counter=0),0===this.init_apple_counter&&(t.is_checkout&&e("[name='woocommerce_checkout_place_order']").attr("data-monei","submit"),t.instantiate_payment_request(),t.$payment_request_container=document.getElementById("payment-request-container"),this.init_apple_counter++)},instantiate_payment_request:function(){var e=monei.PaymentRequest({accountId:wc_monei_apple_google_params.account_id,sessionId:wc_monei_apple_google_params.session_id,amount:parseInt(t.total),currency:wc_monei_apple_google_params.currency,onSubmit(e){t.apple_google_token_handler(e.token)},onError(e){console.error(e)}});e.render("#payment-request-container"),window.paymentRequest=e},apple_google_token_handler:function(o){e("#place_order").prop("disabled",!1),t.create_hidden_input("monei_payment_request_token","payment-request-form",o),t.form.submit()},create_hidden_input:function(e,o,n){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",e),a.setAttribute("id",e),a.setAttribute("value",n),t.$paymentForm=document.getElementById(o),t.$paymentForm.appendChild(a)},update_apple_google_label:function(){const e=window.ApplePaySession?.canMakePayments();if(e){const e=document.querySelector('label[for="payment_method_monei_apple_google"]');if(e){e.childNodes[0].nodeValue="Apple Pay ";const t=e.querySelector("img");t&&(t.src=wc_monei_apple_google_params.apple_logo,t.alt="Apple Pay")}}}};e(function(){t.init(),t.update_apple_google_label()})}(jQuery);