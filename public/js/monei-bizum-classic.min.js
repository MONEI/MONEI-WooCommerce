!function(e){"use strict";e(document.body).on("updated_checkout",function(e,t){"object"==typeof t&&t.fragments&&t.fragments.monei_new_total&&(o.total=t.fragments.monei_new_total),o.is_bizum_selected()&&o.init_checkout_bizum()}),e("form#add_payment_method").on("click payment_methods",function(){o.is_bizum_selected()&&o.init_checkout_bizum()}),e("form#order_review").on("click",function(){o.is_bizum_selected()&&o.init_checkout_bizum()});var t=document.getElementById("order_review");t&&new MutationObserver(function(e,t){for(var n of e)"childList"===n.type&&o.is_bizum_selected()&&o.on_payment_selected()}).observe(t,{childList:!0,subtree:!0});var o={$checkout_form:e("form.woocommerce-checkout"),$add_payment_form:e("form#add_payment_method"),$order_pay_form:e("form#order_review"),$container:null,$paymentForm:null,is_checkout:!1,is_add_payment_method:!1,is_order_pay:!1,form:null,submitted:!1,init_counter:0,total:wc_bizum_params.total,init:function(){this.$checkout_form.length&&(this.is_checkout=!0,this.form=this.$checkout_form),this.$add_payment_form.length&&(this.is_add_payment_method=!0,this.form=this.$add_payment_form),this.$order_pay_form.length&&(o.is_bizum_selected()&&o.init_checkout_bizum(),this.is_order_pay=!0,this.form=this.$order_pay_form,console.log("TOTAL",this.form)),this.form&&this.form.on("change",this.on_change)},on_change:function(){e("[name='payment_method']").on("change",function(){o.on_payment_selected()})},on_payment_selected(){o.is_bizum_selected()?(o.init_checkout_bizum(),o.is_checkout&&e("[name='woocommerce_checkout_place_order']").attr("bizum-data-monei","submit"),e("#place_order").prop("disabled",!0)):(o.is_checkout&&e("[name='woocommerce_checkout_place_order']").removeAttr("bizum-data-monei"),o.is_apple_selected()||e("#place_order").prop("disabled",!1))},is_bizum_selected:function(){return e("#payment_method_monei_bizum").is(":checked")},is_apple_selected:function(){return e("#payment_method_monei_apple_google").is(":checked")},init_bizum_component:function(){window.bizumRequest&&window.bizumRequest.close(),o.instantiate_payment_request()},instantiate_payment_request:function(){var t=monei.Bizum({accountId:wc_bizum_params.account_id,sessionId:wc_bizum_params.session_id,amount:parseInt(o.total),currency:wc_bizum_params.currency,onSubmit(t){e("#place_order").prop("disabled",!1),o.request_token_handler(t.token)},onError(e){console.error(e)}});t.render("#bizum-container"),window.bizumRequest=t},init_checkout_bizum:function(){o.$container&&0===o.$container.childElementCount&&(o.init_counter=0),0===this.init_counter&&(o.is_checkout&&e("[name='woocommerce_checkout_place_order']").attr("bizum-data-monei","submit"),o.init_bizum_component(),o.$container=document.getElementById("bizum-container"),this.init_counter++)},request_token_handler:function(t){o.create_hidden_input("monei_payment_request_token",t),e("#place_order").prop("disabled",!1),o.form.submit()},create_hidden_input:function(e,t){var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name",e),n.setAttribute("id",e),n.setAttribute("value",t),o.$paymentForm=document.getElementById("monei-bizum-form"),o.$paymentForm.appendChild(n)}};e(function(){o.init()})}(jQuery);