(()=>{"use strict";const e=()=>document.querySelector(".wc-block-components-button.wp-element-button.wc-block-components-checkout-place-order-button"),t=window.ReactJSXRuntime,o=e=>{const o=window.ApplePaySession?.canMakePayments?.(),n=!1!==e.logo_apple;let s=!(!1===e.logo_google)&&e.logo_google;s=o&&n?e.logo_apple:s;const a=o&&n?"Apple Pay":"Google Pay",r=o&&e?.logo_apple||!o&&e?.logo_google;return(0,t.jsxs)("div",{className:"monei-label-container",children:[(0,t.jsx)("span",{className:"monei-text",children:a}),r&&(0,t.jsx)("div",{className:"monei-logo",children:(0,t.jsx)("img",{src:s,alt:""})})]})},n=o=>{const{useEffect:n,useRef:s}=wp.element,{responseTypes:a}=o.emitResponse,{onPaymentSetup:r}=o.eventRegistration,{activePaymentMethod:c}=o,i=o.moneiData||wc.wcSettings.getSetting("monei_apple_google_data"),l=s(null),m=(t=>{const{useEffect:o,useState:n,useRef:s}=wp.element,[a,r]=n(!1),c=s(null);return o(()=>{if(!t.isActive)return;const o=e();return o?(a||(o.style.color="black",o.style.backgroundColor="#ccc",o.disabled=!0),()=>{o.style.color="",o.style.backgroundColor="",o.disabled=!1}):void 0},[t.isActive,a]),{enableCheckout:t=>{c.current=t,r(!0);const o=e();o&&(o.style.color="",o.style.backgroundColor="",o.disabled=!1,o.click())},getPaymentData:()=>c.current?{type:t.emitResponse.responseTypes.SUCCESS,meta:{paymentMethodData:{[t.tokenFieldName]:c.current}}}:{type:t.emitResponse.responseTypes.ERROR,message:t.errorMessage||"Payment token required"},tokenRef:c}})({isActive:c===(o.paymentMethodId||"monei_apple_google"),emitResponse:o.emitResponse,tokenFieldName:"monei_payment_request_token",errorMessage:i.tokenErrorString});return n(()=>((()=>{if("undefined"==typeof monei||!monei.PaymentRequest)return void console.error("MONEI SDK is not available");if(l.current?.close)try{l.current.close()}catch(e){}const e=monei.PaymentRequest({accountId:i.accountId,sessionId:i.sessionId,language:i.language,amount:Math.round(100*i.total),currency:i.currency,onSubmit(e){e.token&&m.enableCheckout(e.token)},onError(e){console.error(e)}}),t=document.getElementById("payment-request-container");t&&(e.render(t),l.current=e)})(),()=>{if(l.current?.close)try{l.current.close()}catch(e){}}),[]),n(()=>{const e=r(()=>m.getPaymentData());return()=>e()},[r,m.tokenRef.current]),(0,t.jsxs)("fieldset",{className:"monei-fieldset monei-payment-request-fieldset",children:[(0,t.jsx)("div",{id:"payment-request-container",className:"monei-payment-request-container"}),(0,t.jsx)("input",{type:"hidden",id:"monei_payment_token",name:"monei_payment_token",value:""}),(0,t.jsx)("div",{id:"monei-card-error",className:"monei-error"})]})};!function(){const{registerPaymentMethod:e}=wc.wcBlocksRegistry,{__}=wp.i18n,s=wc.wcSettings.getSetting("monei_apple_google_data");e({name:"monei_apple_google",paymentMethodId:"monei_apple_google",label:o(s),ariaLabel:__("Apple/Google Pay Payment Gateway","monei"),content:(0,t.jsx)(n,{}),edit:(0,t.jsx)("div",{children:__("MONEI Payment Form (Edit Mode)","monei")}),canMakePayment:()=>!0,supports:{features:["products"]}})}()})();