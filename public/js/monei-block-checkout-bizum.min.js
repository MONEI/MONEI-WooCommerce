(()=>{"use strict";const e=window.ReactJSXRuntime;!function(){const{registerPaymentMethod:n}=wc.wcBlocksRegistry,{__}=wp.i18n,{useEffect:o}=wp.element,t=wc.wcSettings.getSetting("monei_bizum_data"),c=n=>{const{responseTypes:c}=n.emitResponse,{onPaymentSetup:i,onCheckoutSuccess:s}=n.eventRegistration,{activePaymentMethod:r}=n;let a=null;o(()=>{const e=document.querySelector(".wc-block-components-button.wp-element-button.wc-block-components-checkout-place-order-button.wc-block-components-checkout-place-order-button");return"monei_bizum"===r&&e&&(e.style.color="black",e.style.backgroundColor="#ccc",e.disabled=!0),()=>{e&&(e.style.color="",e.style.backgroundColor="",e.disabled=!1)}},[r]),o(()=>{"undefined"!=typeof monei&&monei.Bizum?l():console.error("MONEI SDK is not available")},[]);const l=()=>{const e=monei.Bizum({accountId:t.accountId,sessionId:t.sessionId,language:t.language,amount:parseInt(100*t.total),currency:t.currency,onSubmit(e){if(e.token){a=e.token;const n=document.querySelector(".wc-block-components-button.wp-element-button.wc-block-components-checkout-place-order-button.wc-block-components-checkout-place-order-button");n?(n.style.color="",n.style.backgroundColor="",n.disabled=!1,n.click()):console.error("Place Order button not found.")}},onError(e){console.error(e)}}),n=document.getElementById("bizum-container");e.render(n)};return o(()=>{const e=i(()=>a?{type:c.SUCCESS,meta:{paymentMethodData:{monei_payment_request_token:a,monei_is_block_checkout:"yes"}}}:{type:"error",message:__("MONEI token could not be generated.","monei")});return()=>{e()}},[i]),o(()=>{const e=s(({processingResponse:e})=>{const{paymentDetails:n}=e;if(n&&n.paymentId){const e=n.paymentId,o=n.token;monei.confirmPayment({paymentId:e,paymentToken:o}).then(e=>{e.nextAction&&e.nextAction.mustRedirect&&window.location.assign(e.nextAction.redirectUrl),"FAILED"===e.status?window.location.href=`${n.failUrl}&status=FAILED`:window.location.href=n.completeUrl}).catch(e=>{console.error("Error during payment confirmation:",e),window.location.href=n.failUrl})}else console.error("No paymentId found in paymentDetails");return!0});return()=>{e()}},[s]),(0,e.jsxs)("fieldset",{className:"monei-fieldset monei-payment-request-fieldset",children:[(0,e.jsx)("div",{id:"bizum-container",className:"monei-payment-request-container"}),(0,e.jsx)("input",{type:"hidden",id:"monei_payment_token",name:"monei_payment_token",value:""}),(0,e.jsx)("div",{id:"monei-card-error",className:"monei-error"})]})};n({name:"monei_bizum",label:(0,e.jsxs)("div",{children:[" ",(0,e.jsxs)("div",{className:"monei-label-container",children:[(0,e.jsx)("span",{className:"monei-text",children:__(t.title,"monei")}),t?.logo&&(0,e.jsx)("div",{className:"monei-logo",children:(0,e.jsx)("img",{src:t.logo,alt:""})})]})," "]}),ariaLabel:__(t.title,"monei"),content:(0,e.jsx)(c,{}),edit:(0,e.jsxs)("div",{children:[" ",__(t.title,"monei")]}),canMakePayment:({billingData:e})=>"ES"===e.country&&!t.cart_has_subscription,supports:t.supports})}()})();